if(yiliaConfig.open_in_new){document.querySelectorAll(".article-title,.article-more-a,.archive-article-date,.archive-article-title").forEach(i=>{i.setAttribute("target","_blank")});if(yiliaConfig.isPost)document.querySelectorAll(".article-title,.archive-article-date").forEach(i=>{i.removeAttribute("target")})}const progressElement=window.document.querySelector('.progress-bar');if(progressElement){new ScrollProgress((x,y)=>{progressElement.style.width=y*100+'%'})}var $container=document.getElementById("container");if(yiliaConfig.isPost&&typeof(jQuery)!='undefined'){function tocChild(key,value){for(var i=0;i<$toc_child.length;i++){$toc_child[i].style.cssText=key+":"+value}};function getElementTop(element){var actualTop=element.offsetTop;var current=element.offsetParent;while(current!==null){actualTop+=current.offsetTop;current=current.offsetParent}return actualTop};function toToc(name){var $name=document.getElementById(name.substring(1));var scrollPositionTop=getElementTop($name);$('#container').animate({scrollTop:scrollPositionTop},1000);$('body,html').animate({scrollTop:scrollPositionTop-50},1000)};var $article_content=document.getElementById('article-content');var $toc_article=document.getElementsByClassName("toc-article")[0];var $toc_child=document.getElementsByClassName("toc-child");var $toc_link=document.getElementsByClassName("toc-link");tocChild("display","none");for(var i in $toc_link){$toc_link[i].onclick=function(e){e.preventDefault();toToc(decodeURI(this.getAttribute('href')))}};var isanchor=yiliaConfig.anchor;var updateAnchor=function(anchor){if(window.history.replaceState&&anchor!==window.location.hash){window.history.replaceState(undefined,undefined,anchor)}};var expandToc=function($item){if($item.is(':visible')){return}$item.fadeIn(400)};var autoScrollToc=function(){if(document.querySelector('.toc-link.active')){var activePosition=$('.toc-link.active').position().top;var articleScrolltop=$toc_article.scrollTop;if(activePosition>$toc_article.clientHeight-50){$toc_article.scrollTop=articleScrolltop+150}if(activePosition<50){$toc_article.scrollTop=articleScrolltop-150;if(activePosition<0)$toc_article.scrollTop=0}}};$container.addEventListener('scroll',(e)=>{var currentTop=$container.scrollTop;findHeadPosition(currentTop);autoScrollToc()});window.addEventListener('scroll',(e)=>{var currentTop=document.body.scrollTop||document.documentElement.scrollTop;findHeadPosition(currentTop+50);autoScrollToc()});var findHeadPosition=function(top){if($toc_link.length===0){return false};var list=$article_content.querySelectorAll('h1,h2,h3,h4,h5,h6');var currentId='';list.forEach(function(ele){if(top>getElementTop(ele)-10){currentId='#'+ele.getAttribute('id')}});var hexoVersion=(null!=document.querySelector('meta[name="generator"]'))?document.querySelector('meta[name="generator"]').getAttribute("content").substring(5,6):null;var currentActive=$toc_article.querySelectorAll('.active');if(currentId===''){currentActive.forEach(i=>{i.classList.remove('active')});tocChild("display","none")};if(currentId&&decodeURI(currentActive[0]!=null?currentActive[0].getAttribute('href'):null)!==currentId){if(isanchor)updateAnchor(currentId);$toc_article.querySelectorAll('.active').forEach(i=>{i.classList.remove('active')});var _this=(null!=hexoVersion&&hexoVersion>=5)?document.querySelectorAll('.toc-link[href="'+encodeURI(currentId)+'"]')[0]:document.querySelectorAll('.toc-link[href="'+currentId+'"]')[0];_this.classList.add('active');var parents=$(_this).parents('.toc-child');var topLink=(parents.length>0)?parents.last():$(_this);expandToc(topLink.closest('.toc-item').find('.toc-child'));topLink.closest('.toc-item').siblings('.toc-item').find('.toc-child').hide()}}};if(yiliaConfig.isPost&&yiliaConfig.scrollPos){window.onbeforeunload=function(){var scrollPos=$container.scrollTop||document.documentElement.scrollTop||document.body.scrollTop;document.cookie="scrollTop="+scrollPos};window.onpagehide=function(){var scrollPos=$container.scrollTop||document.documentElement.scrollTop||document.body.scrollTop;document.cookie="scrollTop="+scrollPos};window.addEventListener("load",function(){if(document.cookie.match(/scrollTop=([^;]+)(;|$)/)!=null){var arr=document.cookie.match(/scrollTop=([^;]+)(;|$)/);$container.scrollTop=arr[1];document.documentElement.scrollTop=parseInt(arr[1]);document.body.scrollTop=parseInt(arr[1])}})};